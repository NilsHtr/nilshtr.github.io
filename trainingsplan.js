const columnTemplates={Fitness:["\xdcbung","Gewicht [kg]","Wiederholungen","S\xe4tze","Ger\xe4teeinstellungen / Hilfsmittel / Trainingsmittel","Notizen"],Laufen:["Strecke [km]","Dauer","Pace","Herzfrequenz","Untergrund","Notizen"],Schwimmen:["Stil","Bahnen","Dauer","Wassertemperatur","Hilfsmittel","Notizen"],Radfahren:["Strecke [km]","Dauer","H\xf6henmeter","Durchschnittsgeschwindigkeit","Radtyp","Notizen"],Yoga:["\xdcbung","Dauer","Wiederholungen","Schwierigkeit","Hilfsmittel","Notizen"]};document.addEventListener("DOMContentLoaded",()=>{let e=localStorage.getItem("selectedSport");if(!e){window.location.href="index.html";return}let t=document.getElementById("sportType");t.textContent=e.charAt(0).toUpperCase()+e.slice(1);let n=document.getElementById("headerRow"),l=document.getElementById("trainingTable"),i=document.getElementById("addRow"),r=document.getElementById("addColumn"),a=document.getElementById("finishTraining"),d=document.getElementById("showHistory");function c(){let e=document.createElement("button");return e.textContent="❌",e.className="delete-row-btn",e.addEventListener("click",function(){if(confirm("M\xf6chten Sie diese Zeile wirklich l\xf6schen?")){let e=this.closest("tr");e.remove(),u()}}),e}function o(){let e=document.createElement("button");return e.textContent="❌",e.className="delete-column-btn",e.addEventListener("click",function(){if(confirm("M\xf6chten Sie diese Spalte wirklich l\xf6schen?")){let e=this.closest("th"),t=Array.from(e.parentElement.children).indexOf(e);e.remove();let n=l.querySelectorAll("tbody tr");n.forEach(e=>{e.children[t].remove()}),u()}}),e}let h=columnTemplates[e.charAt(0).toUpperCase()+e.slice(1)];h.forEach(e=>{let t=document.createElement("th"),l=document.createElement("div");l.className="header-content";let i=document.createElement("span");i.contentEditable=!0,i.textContent=e,l.appendChild(i),l.appendChild(o()),t.appendChild(l),n.appendChild(t)});let s=document.createElement("th");function m(){let e=l.querySelector("tbody"),t=document.createElement("tr"),i=n.children.length-1;for(let r=0;r<i;r++){let a=document.createElement("td");a.contentEditable=!0,t.appendChild(a)}let d=document.createElement("td");d.appendChild(c()),t.appendChild(d),e.appendChild(t)}function p(){n.children.length;let e=document.createElement("th"),t=document.createElement("div");t.className="header-content";let i=document.createElement("span");i.contentEditable=!0,i.textContent="Neue Spalte",t.appendChild(i),t.appendChild(o()),e.appendChild(t),n.insertBefore(e,n.lastElementChild);let r=l.querySelectorAll("tbody tr");r.forEach(e=>{let t=document.createElement("td");t.contentEditable=!0,e.insertBefore(t,e.lastElementChild)}),u()}function E(){return{headers:Array.from(n.children).slice(0,-1).map(e=>e.querySelector(".header-content span").textContent),rows:Array.from(l.querySelector("tbody").children).map(e=>Array.from(e.children).slice(0,-1).map(e=>e.textContent))}}function u(){let t=E();localStorage.setItem(`trainingPlanData_${e}`,JSON.stringify(t))}s.textContent="Zeile l\xf6schen",s.contentEditable=!1,n.appendChild(s),m(),i.addEventListener("click",m),r.addEventListener("click",p),l.addEventListener("input",u),a.addEventListener("click",()=>{let t=E(),n=`trainingHistory_${e}`,l=JSON.parse(localStorage.getItem(n)||"[]");l.push({date:new Date().toISOString(),tableData:t}),localStorage.setItem(n,JSON.stringify(l)),alert("Training wurde erfolgreich gespeichert!")}),d.addEventListener("click",()=>{window.location.href="history.html"});let f=localStorage.getItem(`trainingPlanData_${e}`);if(f){let C=JSON.parse(f);for(;n.children.length>1;)n.firstElementChild.remove();C.headers.forEach(e=>{let t=document.createElement("th"),l=document.createElement("div");l.className="header-content";let i=document.createElement("span");i.contentEditable=!0,i.textContent=e,l.appendChild(i),l.appendChild(o()),t.appendChild(l),n.insertBefore(t,n.lastElementChild)});let g=l.querySelector("tbody");g.innerHTML="",C.rows.forEach(e=>{let t=document.createElement("tr");e.forEach(e=>{let n=document.createElement("td");n.contentEditable=!0,n.textContent=e,t.appendChild(n)});let n=document.createElement("td");n.appendChild(c()),t.appendChild(n),g.appendChild(t)})}});